<span id="execute" title="execute"> <img class="buttonimage"
	height="16px"
	src=" data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEBLAEsAAD/4QjWRXhpZgAASUkqAAgAAAAHAA4BAgASAAAAYgAAABoBBQABAAAAdAAAABsBBQABAAAAfAAAACgBAwABAAAAAgAAADEBAgANAAAAhAAAADIBAgAUAAAAkgAAAGmHBAABAAAApgAAAN4AAABDcmVhdGVkIHdpdGggR0lNUAAsAQAAAQAAACwBAAABAAAAR0lNUCAyLjEwLjE4AAAyMDIyOjEyOjIxIDA5OjQ0OjIxAAIAhpIHABkAAADEAAAAAaADAAEAAAABAAAAAAAAAAAAAAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVAACAAAAQQAAQAAAAABAAABAQQAAQAAAAABAAACAQMAAwAAAEQBAAADAQMAAQAAAAYAAAAGAQMAAQAAAAYAAAAVAQMAAQAAAAMAAAABAgQAAQAAAEoBAAACAgQAAQAAAIMHAAAAAAAACAAIAAgA/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAEAAQADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3SiiipIKVFFFSZmlRRRVmxLRRRTGFFFFABRRRSASiiimAtFFFABRRRQAtFFFABRRRQIKKKKACiiigYUUUUAFFFFABRRRQBjUUUViYHntFFFcJ5xs0UUVZsdNRRRXadhp0UUVRqWKKKKsQlFFFAx1FFFQMKKKKoAooooAKKKKACiiigAooooAKKKKACiiigAooooAxKKKKyMTyyiiivDPBKNFFFc5zmpRRRXYdh01FFFd53HS0UUV0HaatFFFampPRRRVEi0UUUihKKKKAFooooAKKKKACiiigAooooAKKKKACiiigDEooorIxPKqKKK8U8Iy6KKK844x1FFFWUS0UUVqUatFFFdJ1HR0UUV3HcdNRRRXUdhrUUUVubFiiiigYUUUUAFFFFAC0UUUAFFFFABRRRQAUUUUAYlFFFZGB5VRRRXiHhGXRRRXAcoUUUVQBRRRQMWiiipIJKKKK3NTXooorrOs6Siiiu47jpaKKK6jrNiiiirNCWiiiqLFooooAKKKKQC0UUUgEoooqgMWiiisjA8qooorxDwjLooorgOUKKKKoAooooAWiiikAlFFFIAooopEk1FFFbGhqUUUV2nYdLRRRXadp01FFFdh2GrRRRTNizRRRWggooooGFFFFIoxaKKKyOc8qooorxDwjLooorgOUKKKKoAoooqCQoooqyxKKKKBhRRRUiFoooqhC0UUUyiSiiitBmrRRRXSdJ0tFFFegdx01FFFbnaatFFFbm5YooopkmNRRRWRkeVUUUV4h4Rl0UUVwHKFFFFUAUUUUAFFFFIBaKKKBCUUUUxhRRRUiCiiiqGLRRRUki0UUVRoPooorYo1qKKK6jpOmoooruPQOsooorrO0jooopEHlVFFFeIeEZdFFFcByhRRRVAFFFFIAooooEFFFFIAooopgFFFFMYUUUUAFFFFSSOoooqzQs0UUVsaG5RRRXcdh1NFFFdx3nSUUUVsdJUooopEHlVFFFeIeEZdFFFcByhRRRVAFFFFQISiiirKFooooGFFFFIkKKKKQDqKKKsos0UUVuaGvRRRXWdZ1dFFFdx3nR0UUVudJfooorU1JKKKKAMWiiisjA8qooorxDwjLooorgOUKKKKoAooopDCiiigQUUUUCFooooAs0UUV0Ghs0UUV2HcdRRRRXWdp0lFFFdZ2GhRRRVDJKKKKZoFFFFABRRRQSYtFFFZmJ5VRRRXiHhGXRRRXAcoUUUVQCUUUUAOooopCJ6KKK3NjYooorsOw6miiiu07jo6KKK6jrNOiiitDQfRRRQA6iiigAooooEFFFFAxtFFFAGNRRRWRieVUUUV4h4Jl0UUVwHILRRRVlE1FFFalmxRRRXWdR01FFFdx3nSUUUV0nYalFFFampNRRRQAUUUUALRRRQAUUUUAFFFFABRRRQAUUUUAYdFFFZGJ5bRRRXiHglGiiiucwNaiiiuw6zpqKKK7jvOlooorpOw1KKKK1NSaiiigQtFFFAwooooASiiigBaKKKACiiigAooooAKKKKACiiigDFooorEwPPaKKK4TzjaooorQ2OnooorsOw06KKKZqTUUUVoIWiiigYUUUVmMKKKKsBaKKKACiiigAooooAKKKKACiiigAooooAKKKKAKVFFFQQUKKKKkzNWiiirNiWiiimMWiiimAUUUUAFFFFAgooooAWiiigYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//ZAP/iArBJQ0NfUFJPRklMRQABAQAAAqBsY21zBDAAAG1udHJSR0IgWFlaIAfmAAwAFQAAACsAEWFjc3BBUFBMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD21gABAAAAANMtbGNtcwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADWRlc2MAAAEgAAAAQGNwcnQAAAFgAAAANnd0cHQAAAGYAAAAFGNoYWQAAAGsAAAALHJYWVoAAAHYAAAAFGJYWVoAAAHsAAAAFGdYWVoAAAIAAAAAFHJUUkMAAAIUAAAAIGdUUkMAAAIUAAAAIGJUUkMAAAIUAAAAIGNocm0AAAI0AAAAJGRtbmQAAAJYAAAAJGRtZGQAAAJ8AAAAJG1sdWMAAAAAAAAAAQAAAAxlblVTAAAAJAAAABwARwBJAE0AUAAgAGIAdQBpAGwAdAAtAGkAbgAgAHMAUgBHAEJtbHVjAAAAAAAAAAEAAAAMZW5VUwAAABoAAAAcAFAAdQBiAGwAaQBjACAARABvAG0AYQBpAG4AAFhZWiAAAAAAAAD21gABAAAAANMtc2YzMgAAAAAAAQxCAAAF3v//8yUAAAeTAAD9kP//+6H///2iAAAD3AAAwG5YWVogAAAAAAAAb6AAADj1AAADkFhZWiAAAAAAAAAknwAAD4QAALbEWFlaIAAAAAAAAGKXAAC3hwAAGNlwYXJhAAAAAAADAAAAAmZmAADypwAADVkAABPQAAAKW2Nocm0AAAAAAAMAAAAAo9cAAFR8AABMzQAAmZoAACZnAAAPXG1sdWMAAAAAAAAAAQAAAAxlblVTAAAACAAAABwARwBJAE0AUG1sdWMAAAAAAAAAAQAAAAxlblVTAAAACAAAABwAcwBSAEcAQv/bAEMAAwICAwICAwMDAwQDAwQFCAUFBAQFCgcHBggMCgwMCwoLCw0OEhANDhEOCwsQFhARExQVFRUMDxcYFhQYEhQVFP/bAEMBAwQEBQQFCQUFCRQNCw0UFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFP/+ABRDcmVhdGVkIHdpdGggR0lNUAD/wgARCAAQABADAREAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAABwb/xAAVAQEBAAAAAAAAAAAAAAAAAAAFBv/aAAwDAQACEAMQAAABvpiXQ2WTwYZGab//xAAZEAEAAwEBAAAAAAAAAAAAAAAFAQQGABb/2gAIAQEAAQUCnTWjkTdFUR7zNlFE3P1DY//EAB0RAAICAwADAAAAAAAAAAAAAAEDAAIEESEFMTL/2gAIAQMBAT8BOexDrVPRuIzFP9HsPj2Pdax4NxGIpHyOz//EABsRAAICAwEAAAAAAAAAAAAAAAEDAAIEBSEy/9oACAECAQE/AbbBiHWqeiIzFP8AJ7Dr2Pdax4InEUjyJ//EAB8QAAICAQQDAAAAAAAAAAAAAAECAAMEESIjUhITQf/aAAgBAQAGPwLIQ81IsO1oAG9dnRpkOeGk2Hc32aqnnZ3af//EABsQAQACAwEBAAAAAAAAAAAAAAEAETFBgVFh/9oACAEBAAE/IVCAJmC9MBt34vPYnOwmYXogLqd55P/aAAwDAQACAAMAAAAQTW//xAAbEQACAgMBAAAAAAAAAAAAAAABIQARMUFRcf/aAAgBAwEBPxBMCSOvDE9XBzGApPZ8ED3Z0cz/xAAbEQEAAQUBAAAAAAAAAAAAAAABABEhMVFxQf/aAAgBAgEBPxCwArb04wOlDRzGDqr1hOR25n//xAAcEAEAAwACAwAAAAAAAAAAAAABACExEXFRYYH/2gAIAQEAAT8QbmIOrWx1kPPWXEfCyCqDA0b2e2oQ8ixOf0z4n//Z" />
</span>

<script>
	let deleteButton = " data:image/png;base64,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";
	function getTableName(query) {
		query = query.trim().toLowerCase().replaceAll('\n', ' ').replaceAll('\t', ' ');
		if(!new RegExp(/^select /).test(query)) return "";
		let arr = [...query.matchAll("from +[a-z(_0-9]+")];
		if(arr.length > 1) return "";
		let r = arr[0][0].split(" ");
		return r[r.length - 1].toUpperCase();
	}

	z("#execute").click(function() {
		let v = z("#editor").val();
		let tblname = getTableName(v);
		let ajax =new Ajax().addData("query", v);
		if(new RegExp(/^select /).test(v.trim().toLowerCase())) {
			ajax.setPath("[[${path.SELECT_QUERY}]]").onSuccess(function(data) {
				createRow = function(data, row, className) {
					row.addCls(className);
					data.forEach(e => {
						let cell = row.cell();
						cell.html(e);
					})
					if(tblname != "") {
						let buttoncell = row.cell();
						let img = buttoncell.child("img")
						img.src(deleteButton);
						if(row.index() > 0) {
							img.click(function() {
								let proRow = z(this).parent().parent();
								let colCount = proRow.len();
								let cols = new StringJoiner(",\n");
								proRow.parent().row(0).each("td", e=>{
									let i = e.cellIndex();
									if(i!=colCount-1)
										cols.add("`"+e.html()+"` = '"+proRow.cell(i).html()+"'");
								});
								z("#editor").val("DELETE FROM " + tblname + " WHERE \n" + cols.toString());
							});
						}
					}
					
				}
				let len = data.result.length;
				z("#executionResult").html("");
				setExecutionTime(data.time);
				let table = z("#executionResult").child("table");
				createRow(data.result[0], table.row(), "datatrhead");
				for(let i = 1; i < len; i++) {
					createRow(data.result[i], table.row(), "datatr");
				}
			}).putJson();
		} else {
			ajax.setPath("[[${path.EXECUTE}]]").onSuccess(function(data) {
				z("#executionResult").html(data.result.result);
				updateTableList();
			}).putJson();
		}
	}) 

	function updateTableList() {
		let mergeData = {};
		let parent = z("#tableNameList");
		parent.html("");
		new Ajax().path("[[${path.TABLE_LIST}]]/").onSuccess(function(data) {
			if(data.result.length > 0)
				data.result.forEach(dt => parent.mk("div").cls("divclass").id(dt).html(dt))
			else parent.mk("div").cls("notabledivclass").id("notable").html("No Table found");
			assingClickToTableDiv();
			hideModifyColumn();
		}).get()
	}
</script>
